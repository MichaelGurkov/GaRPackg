raw_df = import_from_fame_template(
paste0("C:\\Users\\U095\\Documents\\Data",
"\\gar_data\\data_fame.csv") %>%
rename_all(tolower))
temp = read.csv(paste0("C:\\Users\\U095\\Documents\\Data",
"\\gar_data\\data_fame.csv"), stringsAsFactors = FALSE)
temp = read.csv(paste0("C:\\Users\\U095\\Documents\\Data",
"\\gar_data\\data_fame.csv"), stringsAsFactors = FALSE) %>%
dplyr::slice(-(1:10))
temp = read.csv(paste0("C:\\Users\\U095\\Documents\\Data",
"\\gar_data\\data_fame.csv"), stringsAsFactors = FALSE) %>%
dplyr::slice(-(1:10)) %>%
dplyr::rename(date = 1)
temp = read.csv(paste0("C:\\Users\\U095\\Documents\\Data",
"\\gar_data\\data_fame.csv"), stringsAsFactors = FALSE) %>%
dplyr::slice(-(1:10)) %>%
dplyr::rename(date = 1) %>%
dplyr::mutate(date = parse_date_time(.data$date,orders = c("dmy","mdy")))
devtools::load_all()
temp = import_from_fame_template(paste0("C:\\Users\\U095\\Documents\\Data",
"\\gar_data\\data_fame.csv"))
temp = import_from_fame_template(paste0("C:\\Users\\U095\\Documents\\Data",
"\\gar_data\\data_fame.csv"))
names(temp)
parameters_list = list()
parameters_list$quantile_vec = c(0.05, 0.25, 0.5, 0.75, 0.95)
parameters_list$horizon_list = list(1, 4, 8, 12)
parameters_list$drop_series = c(
"vacancies_rate",
"telbor_1Y",
"STARTUP_FP",
"sovereigh_spread",
"interbank_spread",
"lt_real_rate_change",
"indus_prod_ind",
"ils_euro",
"breakeven_inflation_5_10_fwd"
)
parameters_list$vars_to_yoy = c(
"ind_prod_us",
"ind_prod_euro",
"Ind_Prod_Israel",
"gdp",
"private_consumption",
"public_consumption",
"investment",
"exports",
"imports",
"dom_gdp",
"credit",
"ta125_close",
"house_price",
"sp500",
"dxy",
"eurostoxx600",
"state_of_economy_ind",
"oecd_imp",
"oil_p",
"non_energy_p"
)
parameters_list$vars_to_diff = c(
"boi_rate",
"rate_us",
"rate_euro",
"unemployment"
)
parameters_list$vars_to_4_ma = c(
"gdp_us",
"gdp_euro"
)
devtools::load_all()
parameters_list = list()
parameters_list$quantile_vec = c(0.05, 0.25, 0.5, 0.75, 0.95)
parameters_list$horizon_list = list(1, 4, 8, 12)
parameters_list$drop_series = c(
"vacancies_rate",
"telbor_1Y",
"STARTUP_FP",
"sovereigh_spread",
"interbank_spread",
"lt_real_rate_change",
"indus_prod_ind",
"ils_euro",
"breakeven_inflation_5_10_fwd"
)
parameters_list$vars_to_yoy = c(
"ind_prod_us",
"ind_prod_euro",
"Ind_Prod_Israel",
"gdp",
"private_consumption",
"public_consumption",
"investment",
"exports",
"imports",
"dom_gdp",
"credit",
"ta125_close",
"house_price",
"sp500",
"dxy",
"eurostoxx600",
"state_of_economy_ind",
"oecd_imp",
"oil_p",
"non_energy_p"
)
parameters_list$vars_to_diff = c(
"boi_rate",
"rate_us",
"rate_euro",
"unemployment"
)
parameters_list$vars_to_4_ma = c(
"gdp_us",
"gdp_euro"
)
raw_df = import_from_fame_template(
paste0(file.path(Sys.getenv("USERPROFILE"),fsep="\\"),
"\\OneDrive - Bank Of Israel\\",
"Data\\BoI\\GaR_Data\\Working_data",
"\\data_fame.csv")) %>%
rename_all(tolower)
file.choose()
raw_df = import_from_fame_template(
paste0("C:\\Users\\U095\\Documents\\Data",
"\\gar_data\\data_fame.csv")) %>%
rename_all(tolower)
df = raw_df %>%
mutate(dom_gdp = private_consumption +
public_consumption + investment) %>%
mutate(across(any_of(parameters_list$vars_to_yoy),
calculate.YoY.returns)) %>%
mutate(across(any_of(parameters_list$vars_to_4_ma),
~ calculate.four.quarters.ma(.) * 4 / 100)) %>%
mutate(across(any_of(parameters_list$vars_to_diff),
~c(NA,diff(.))))
Sys.getenv("USERPROFILE")
file.choose()
devtools::load_all()
raw_df = import_from_fame_template(
paste0("C:\\Users\\U095",
"\\OneDrive - Bank Of Israel\\Data\\BoI\\GaR_Data",
"\\robustness\\data_GaR_20220904.csv")) %>%
rename_all(tolower)
raw_df = import_from_fame_template(
paste0("C:\\Users\\U095",
"\\OneDrive - Bank Of Israel\\Data\\BoI\\GaR_Data",
"\\robustness\\data_GaR_20220904.csv")) %>%
rename_all(tolower)
# Chunk 1: load_libraries
devtools::load_all()
raw_df = import_from_fame_template(
paste0("C:\\Users\\U095",
"\\OneDrive - Bank Of Israel\\Data\\BoI\\GaR_Data",
"\\robustness\\data_GaR_20220904.csv")) %>%
rename_all(tolower)
names(raw_df)
str_subset(names(raw_df),"infl")
?preprocess_df()
str_subset(names(raw_df),"boi")
str_subset(names(raw_df),"cpi")
str_subset(names(raw_df),"spread")
str_subset(names(raw_df),"ils")
str_subset(names(raw_df),"impl")
str_subset(names(raw_df),"credit")
str_subset(names(raw_df),"house")
str_subset(names(raw_df),"ta125")
str_subset(names(raw_df),"ind")
categories_list = list(
categories_list = list(
dom_macro = list(
optional = c(
"gdp_yoy",
"private_consumption_yoy",
"public_consumption_yoy",
"investment_yoy",
"unemployment",
"unemployment_diff",
"unemployment_hpgap",
"cpi_israel_yoy",
"infl_israel_gdp_4_ma"
),
),
dom_fin = list(
optional = c(
"boi_rate_diff",
"boi_rate",
"spread_cpi_corp",
"ils_usd_spread_pct",
"interbank_spread",
"sovereigh_spread",
"term_spread",
"ils_usd_impl_vol",
"ta_35_impl_vol",
"credit_yoy",
"house_price_yoy",
"ta125_close_yoy",
)),
ext_macro = list(
optional = c(
"imports_yoy",
"exports_yoy",
"cpi_us_yoy",
"infl_euro_4_ma",
"ind_prod_us_yoy",
"ind_prod_euro_yoy",
"gdp_us_yoy",
"gdp_euro_yoy",
"oecd_imp"
)),
ext_fin = list(
optional = c(
"rate_euro_diff",
"rate_us_diff",
"rate_euro",
"rate_us",
"vix",
"eurostoxx600",
"sp500",
"us_term_spread",
"dxy_yoy",
"oil_p_yoy",
"non_energy_p_yoy",
)
)
)
list(
optional = c(
"gdp_yoy",
"private_consumption_yoy",
"public_consumption_yoy",
"investment_yoy",
"unemployment",
"unemployment_diff",
"unemployment_hpgap",
"cpi_israel_yoy",
"infl_israel_gdp_4_ma"
),
)
categories_list = list(
dom_macro = list(
optional = c(
"gdp_yoy",
"private_consumption_yoy",
"public_consumption_yoy",
"investment_yoy",
"unemployment",
"unemployment_diff",
"unemployment_hpgap",
"cpi_israel_yoy",
"infl_israel_gdp_4_ma"
)),
dom_fin = list(
optional = c(
"boi_rate_diff",
"boi_rate",
"spread_cpi_corp",
"ils_usd_spread_pct",
"interbank_spread",
"sovereigh_spread",
"term_spread",
"ils_usd_impl_vol",
"ta_35_impl_vol",
"credit_yoy",
"house_price_yoy",
"ta125_close_yoy",
)),
ext_macro = list(
optional = c(
"imports_yoy",
"exports_yoy",
"cpi_us_yoy",
"infl_euro_4_ma",
"ind_prod_us_yoy",
"ind_prod_euro_yoy",
"gdp_us_yoy",
"gdp_euro_yoy",
"oecd_imp"
)),
ext_fin = list(
optional = c(
"rate_euro_diff",
"rate_us_diff",
"rate_euro",
"rate_us",
"vix",
"eurostoxx600",
"sp500",
"us_term_spread",
"dxy_yoy",
"oil_p_yoy",
"non_energy_p_yoy",
)
)
)
list(
optional = c(
"boi_rate_diff",
"boi_rate",
"spread_cpi_corp",
"ils_usd_spread_pct",
"interbank_spread",
"sovereigh_spread",
"term_spread",
"ils_usd_impl_vol",
"ta_35_impl_vol",
"credit_yoy",
"house_price_yoy",
"ta125_close_yoy",
))
categories_list = list(
dom_macro = list(
optional = c(
"gdp_yoy",
"private_consumption_yoy",
"public_consumption_yoy",
"investment_yoy",
"unemployment",
"unemployment_diff",
"unemployment_hpgap",
"cpi_israel_yoy",
"infl_israel_gdp_4_ma"
)),
dom_fin = list(
optional = c(
"boi_rate_diff",
"boi_rate",
"spread_cpi_corp",
"ils_usd_spread_pct",
"interbank_spread",
"sovereigh_spread",
"term_spread",
"ils_usd_impl_vol",
"ta_35_impl_vol",
"credit_yoy",
"house_price_yoy",
"ta125_close_yoy"
)),
ext_macro = list(
optional = c(
"imports_yoy",
"exports_yoy",
"cpi_us_yoy",
"infl_euro_4_ma",
"ind_prod_us_yoy",
"ind_prod_euro_yoy",
"gdp_us_yoy",
"gdp_euro_yoy",
"oecd_imp"
)),
ext_fin = list(
optional = c(
"rate_euro_diff",
"rate_us_diff",
"rate_euro",
"rate_us",
"vix",
"eurostoxx600",
"sp500",
"us_term_spread",
"dxy_yoy",
"oil_p_yoy",
"non_energy_p_yoy",
)
)
)
categories_list = list(
dom_macro = list(
optional = c(
"gdp_yoy",
"private_consumption_yoy",
"public_consumption_yoy",
"investment_yoy",
"unemployment",
"unemployment_diff",
"unemployment_hpgap",
"cpi_israel_yoy",
"infl_israel_gdp_4_ma"
)),
dom_fin = list(
optional = c(
"boi_rate_diff",
"boi_rate",
"spread_cpi_corp",
"ils_usd_spread_pct",
"interbank_spread",
"sovereigh_spread",
"term_spread",
"ils_usd_impl_vol",
"ta_35_impl_vol",
"credit_yoy",
"house_price_yoy",
"ta125_close_yoy"
)),
ext_macro = list(
optional = c(
"imports_yoy",
"exports_yoy",
"cpi_us_yoy",
"infl_euro_4_ma",
"ind_prod_us_yoy",
"ind_prod_euro_yoy",
"gdp_us_yoy",
"gdp_euro_yoy",
"oecd_imp"
)),
ext_fin = list(
optional = c(
"rate_euro_diff",
"rate_us_diff",
"rate_euro",
"rate_us",
"vix",
"eurostoxx600",
"sp500",
"us_term_spread",
"dxy_yoy",
"oil_p_yoy",
"non_energy_p_yoy"
)
)
)
map_dbl(list, length)
map_dbl(categories_list, length)
category_params_df =  categories_list%>%
enframe(name = "category", value = "params")
View(category_params_df)
get_partition_combs
category_params_df =  categories_list%>%
enframe(name = "category", value = "params") %>%
mutate(part_comb_df = map2(category, params,
function(temp_name, temp_part) {
temp_part_df = get_partition_combs(partition_list = temp_part,
partition_name = temp_name)
}))
category_params_df =  categories_list%>%
enframe(name = "category", value = "params") %>%
mutate(part_comb_df = map2(category, params,
function(temp_name, temp_part) {
temp_part_df = get_partition_combs(partition_list = temp_part,
partition_name = temp_name)
}))
devtools::load_all(".")
category_params_df =  categories_list%>%
enframe(name = "category", value = "params") %>%
mutate(part_comb_df = map2(category, params,
function(temp_name, temp_part) {
temp_part_df = get_partition_combs(partition_list = temp_part,
partition_name = temp_name)
}))
args(get_partition_combs)
category_params_df =  categories_list%>%
enframe(name = "category", value = "params") %>%
mutate(part_comb_df = map2(category, params,
function(temp_name, temp_part) {
temp_part_df = get_partition_combs(partitions_list = temp_part,
partition_name = temp_name)
}))
category_params_df %>%
head()
feature_select_df = map(
category_params_df$category,function(temp_cat){
temp_df = category_params_df %>%
filter(category == temp_cat) %>%
select(part_comb_df) %>%
unnest(cols = c(part_comb_df))
return(temp_df)
}
) %>%
reduce(full_join, by = character()) %>%
unite(col = name,starts_with("name"),sep = "-")
category_params_df
512 * 4096 * 512 * 2048
categories_list %>%
map_dbl(length(.[[1]]))
categories_list %>%
map(length(.[[1]]))
categories_list$dom_macro[[1]]
categories_list$dom_macro[[1]][1]
length(categories_list$dom_macro[[1]])
map_dbl(categories_list, length(.[[1]]))
map_dbl(categories_list, function(temp){length(temp[[1]])})
2 ^ 9
2 ^ (9 + 12 + 9 + 11)
# Chunk 1: load_libraries
devtools::load_all()
library(furrr)
file.choose()
temp = read_rds(paste0("C:\\Users\\Home",
"\\OneDrive - Bank Of Israel\\Data\\BoI",
"\\GaR_Data\\robustness\\forecast_results_0.rds"))
head(temp)
temp %>%
slice(1) %>%
pull(gar_forecast)
temp %>%
slice(1) %>%
unnest()
temp %>%
slice(1) %>%
unnest(partition)
temp %>%
slice(1)
temp %>%
slice(1) %>%
unnest(gar_forecast)
temp %>%
unnest(gar_forecast)
temp %>%
slice(1:2) %>%
unnest(gar_forecast)
